{
  "checklist": [
    "Define package layout with correct Go module path (github.com/prethora/echosub_db)",
    "Define sentinel error ErrNotFound with message 'echosubdb: not found' in errors.go",
    "Define sentinel error ErrDuplicateKey with message 'echosubdb: duplicate key' in errors.go",
    "Define sentinel error ErrConnection with message 'echosubdb: connection failed' in errors.go",
    "Define Segment struct with Start (float64), End (float64), Text (string) fields with JSON tags",
    "Define Video struct with ID (string), DurationMs (int32), Hash10-90 (int64), YoutubeID (*string), Title (*string), CreatedAt (time.Time) fields",
    "Define Transcription struct with ID, VideoID, Language (string), Segments ([]Segment), SegmentCount (int32), CreatedAt (time.Time) fields",
    "Define Translation struct with ID, VideoID, TranscriptionID, Language (string), Segments ([]Segment), SegmentCount (int32), CreatedAt (time.Time) fields",
    "Define JobStatus type as string with const definitions for all status values (pending, uploading, transcribing, translating, splitting, complete, failed)",
    "Define Job struct with ID, VideoID (*string), TargetLanguage (string), Status (JobStatus), ErrorMessage (*string), AudioKey (*string), AudioDurationMs (*int32), CreatedAt, StartedAt (*time.Time), CompletedAt (*time.Time) fields",
    "Define Fingerprint struct with DurationMs (int32), Hash10, Hash25, Hash50, Hash75, Hash90 (int64) fields",
    "Define VideoMatch struct with Video (Video), AvgDistance (float64) fields",
    "Define DB struct (opaque, with unexported fields for pgxpool.Pool and sqlc Queries)",
    "Define New(ctx context.Context, databaseURL string) (*DB, error) constructor signature",
    "Define Close() method on DB struct",
    "Define CreateVideo(ctx context.Context, v Video) (Video, error) method signature",
    "Define GetVideo(ctx context.Context, id string) (Video, error) method signature",
    "Define GetVideoByYouTubeID(ctx context.Context, youtubeID string) (Video, error) method signature",
    "Define FindVideosByFingerprint(ctx context.Context, fp Fingerprint, maxAvgDistance float64) ([]VideoMatch, error) method signature",
    "Define CreateTranscription(ctx context.Context, t Transcription) (Transcription, error) method signature",
    "Define GetTranscription(ctx context.Context, id string) (Transcription, error) method signature",
    "Define GetTranscriptionForVideo(ctx context.Context, videoID string) (Transcription, error) method signature",
    "Define TranscriptionExistsForVideo(ctx context.Context, videoID string) (bool, error) method signature",
    "Define CreateTranslation(ctx context.Context, t Translation) (Translation, error) method signature",
    "Define GetTranslation(ctx context.Context, id string) (Translation, error) method signature",
    "Define GetTranslationForVideo(ctx context.Context, videoID string, language string) (Translation, error) method signature",
    "Define ListTranslationsForVideo(ctx context.Context, videoID string) ([]Translation, error) method signature",
    "Define TranslationExistsForVideo(ctx context.Context, videoID string, language string) (bool, error) method signature",
    "Define CreateJob(ctx context.Context, j Job) (Job, error) method signature",
    "Define GetJob(ctx context.Context, id string) (Job, error) method signature",
    "Define UpdateJobStatus(ctx context.Context, id string, status JobStatus, errorMessage *string) error method signature",
    "Define SetJobVideoID(ctx context.Context, id string, videoID string) error method signature",
    "Define ListJobsByStatus(ctx context.Context, status JobStatus) ([]Job, error) method signature",
    "Document import dependencies: context, time from standard library",
    "Document import dependencies: github.com/jackc/pgx/v5/pgxpool for connection pooling",
    "Document import dependencies: github.com/google/uuid for UUID generation",
    "Document that generated/ directory contains sqlc-generated code (models.go, db.go, query files)",
    "Document that queries/ directory contains SQL query files (videos.sql, transcriptions.sql, translations.sql, jobs.sql)",
    "Document that schema.hcl defines database schema using Atlas declarative format",
    "Document that atlas.hcl contains Atlas configuration for multiple environments (local, test, production)",
    "Document that sqlc.yaml configures sqlc code generation (database connection, output directory, Go package name)",
    "Document that migrations/ directory contains Atlas-generated migration SQL files",
    "Document that docker/ directory contains Dockerfile and init script for local PostgreSQL 16 with multi-database support",
    "Document Makefile targets: docker-build, docker-create, docker-start, docker-stop, migrate-diff, migrate-apply, migrate-apply-test, generate, dev-setup, test",
    "Specify Go version requirement: 1.21+ (required for pgx v5)",
    "Specify PostgreSQL version requirement: 16 (for bit_count() function)",
    "Document that DB struct wraps pgxpool.Pool and sqlc Queries struct internally",
    "Document that New() performs connectivity check and fails fast with ErrConnection if database unreachable",
    "Document that Close() is idempotent and safe to call multiple times",
    "Document that all methods accept context.Context for cancellation and timeout support",
    "Document that JSONB marshaling/unmarshaling is handled automatically by sqlc for Segment slices",
    "Document that UUIDs are generated application-side using google/uuid before INSERT operations",
    "Document that foreign keys have CASCADE delete behavior (videos → transcriptions → translations)",
    "Document that jobs.video_id uses SET NULL on delete (preserves job history)",
    "Document thread safety: DB struct is safe for concurrent use across multiple goroutines",
    "Document connection pooling strategy: relies on pgxpool defaults and Supabase's external pooling in production",
    "Document error mapping: pgx.ErrNoRows → ErrNotFound, unique violations → ErrDuplicateKey, connection errors → ErrConnection",
    "Document fingerprint matching algorithm: duration filter (±100ms), Hamming distance calculation per hash position, average distance threshold",
    "Document that hamming_distance() SQL function is defined in schema (uses bit_count and XOR operator)",
    "Document testing approach: 90% integration tests against real PostgreSQL, 10% unit tests for pure logic",
    "Document test database setup: separate 'test' database in same Docker container, schema applied via 'make migrate-apply-test'",
    "Document test isolation: table truncation after test runs (not transaction rollback)",
    "Document DATABASE_URL environment variable format for local: postgres://postgres:123456@localhost:5432/development?sslmode=disable",
    "Document DATABASE_URL environment variable format for Supabase: postgres://[project-ref].[region].pooler.supabase.com:6543/postgres with sslmode=require"
  ]
}
