{
  "directive": "Define unit testing infrastructure including test helpers and mock interfaces.\n\n**Unit Testing Helpers (Checklist Items 27-29)**\n\nIn section 11, create \"11. Unit Testing Infrastructure\":\n\n**11.1 Test Helper Functions** (`tests/unit/helpers.go`):\n\n**NewTestAPIGatewayRequest:**\n```go\nfunc NewTestAPIGatewayRequest(method, path string, body string) events.APIGatewayProxyRequest\n```\n\nThis function creates a mock API Gateway request for unit testing the HandleAPIGateway function. It should populate:\n- HTTPMethod field\n- Path field\n- Body field\n- RequestContext with minimal required fields\n\nThis allows unit tests to test API Gateway handler logic without deploying infrastructure.\n\n**NewTestStepFunctionInput:**\n```go\nfunc NewTestStepFunctionInput(start, iterations, delayMs, counter int) StepFunctionInput\n```\n\nThis function creates a test Step Function input for unit testing the HandleStepFunction function. It populates all fields with provided values and uses defaults from constants if needed.\n\n**11.2 Mock Interfaces** (Checklist Item 27):\n\n**MockLambdaHandler:**\n```go\ntype MockLambdaHandler interface {\n    HandleAPIGateway(ctx context.Context, req APIGatewayRequest) (APIGatewayResponse, error)\n    HandleCustomEvent(ctx context.Context, event json.RawMessage) (CustomEventResponse, error)\n    HandleStepFunction(ctx context.Context, input StepFunctionInput) (StepFunctionOutput, error)\n}\n```\n\nThis interface mirrors the handler functions and allows for mocking in tests. It can be used to test the main Handler routing logic by injecting a mock implementation.\n\n**11.3 Unit Test Structure:**\n\nDocument that unit tests are organized in `tests/unit/` with test files for:\n- `apigateway_test.go` — Tests for HandleAPIGateway\n- `customevent_test.go` — Tests for HandleCustomEvent\n- `stepfunction_test.go` — Tests for HandleStepFunction\n- `router_test.go` — Tests for DetectEventType\n- `main_test.go` — Tests for main Handler routing logic\n\n**Logger Interface (Checklist Item 31):**\n\nNote: The design document does not specify a logging abstraction, so no Logger interface is required. Logging (if needed) can use standard library `log` package or be added in future iterations.\n\n**Summary Section:**\n\nAdd a brief summary at the end noting that:\n- All core types and signatures are defined\n- All infrastructure specifications are complete\n- All testing infrastructure (unit and E2E) is specified\n- The architecture is ready for implementation\n\nThis completes the architecture document.",
  "complete": false
}
