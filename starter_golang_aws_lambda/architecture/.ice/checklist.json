{
  "checklist": [
    "Define package layout showing cmd/lambda, internal/handlers, internal/router, tests, terraform, and scripts directories",
    "Define ErrInvalidEvent sentinel error with 'handler: unable to parse event' message",
    "Define ErrUnsupportedRoute sentinel error with 'handler: unsupported API route' message",
    "Define ErrIterationFailed sentinel error with 'handler: step function iteration failed' message",
    "Define EventType enum/type with constants for APIGateway, StepFunction, and CustomEvent",
    "Define Router interface or function signature for DetectEventType(event json.RawMessage) EventType",
    "Define APIGatewayRequest and APIGatewayResponse types matching AWS Lambda API Gateway proxy integration schema",
    "Define HandleAPIGateway function signature accepting context.Context and APIGatewayRequest, returning APIGatewayResponse and error",
    "Define CustomEventRequest and CustomEventResponse types for echo handler",
    "Define HandleCustomEvent function signature accepting context.Context and json.RawMessage, returning CustomEventResponse and error",
    "Define StepFunctionInput type with Start (int), Iterations (int), DelayMs (int), and Counter (int) fields with JSON tags",
    "Define StepFunctionOutput type with Counter (int), IterationsRemaining (int), and Complete (bool) fields with JSON tags",
    "Define HandleStepFunction function signature accepting context.Context and StepFunctionInput, returning StepFunctionOutput and error",
    "Define main Lambda handler function signature Handler(ctx context.Context, event json.RawMessage) (any, error)",
    "Define Config type with StackName and AWSRegion fields for environment variable loading",
    "Define LoadConfig function signature returning Config and error",
    "Define constants for default AWS region (us-east-1) and default iterations (5) and default delay (1000ms)",
    "Specify build tags for Go version requirement (go 1.23+) in go.mod format",
    "Define Router struct or package with DetectEventType method implementation signature",
    "Define response type for API Gateway handler success case with Message and Source fields and JSON tags 'message' and 'source'",
    "Define response type for Custom Event handler with Source and Echo fields and JSON tags 'source' and 'echo'",
    "Document import requirements: context, encoding/json, errors from stdlib",
    "Document import requirements: github.com/aws/aws-lambda-go/lambda for Lambda runtime",
    "Document import requirements: github.com/aws/aws-lambda-go/events for API Gateway event types",
    "Define test interface MockLambdaHandler for unit testing handlers in isolation",
    "Define test helper function NewTestAPIGatewayRequest for creating mock API Gateway events",
    "Define test helper function NewTestStepFunctionInput for creating test Step Function inputs",
    "Define NewRouter constructor function signature if Router is a struct",
    "Define Logger interface with methods Info, Error, Debug if logging abstraction is used",
    "Specify Dockerfile structure: builder stage and runtime stage separation",
    "Specify Docker base image: public.ecr.aws/lambda/provided:al2023 for runtime stage",
    "Specify Docker CMD format for Lambda: handler executable name 'bootstrap' per AWS requirements",
    "Define Terraform variable definitions: stack_name (string), enable_api_gateway (bool, default true), enable_step_functions (bool, default true), enable_custom_events (bool, default true)",
    "Define Terraform output definitions: lambda_function_arn, api_gateway_url (if enabled), step_function_arn (if enabled)",
    "Document IAM policy requirements: logs:CreateLogGroup, logs:CreateLogStream, logs:PutLogEvents for CloudWatch",
    "Document Step Functions execution role IAM policy requirement: lambda:InvokeFunction permission to invoke the Lambda function",
    "Define naming convention pattern: ${STACK_NAME}-lambda for Lambda function",
    "Define naming convention pattern: ${STACK_NAME}-repo for ECR repository",
    "Define naming convention pattern: ${STACK_NAME}-api for API Gateway",
    "Define naming convention pattern: ${STACK_NAME}-state-machine for Step Functions",
    "Define naming convention pattern: /aws/lambda/${STACK_NAME} for CloudWatch log group",
    "Define E2E test structure with Deploy, TestAPIGateway, TestCustomEvent, TestStepFunctions, Cleanup phases",
    "Define E2E test helper type TestStack with fields for deployed resource ARNs and URLs",
    "Define E2E test DeployTestStack function signature returning TestStack and error",
    "Define E2E test CleanupTestStack function signature accepting TestStack and returning error",
    "Specify script structure: deploy.sh with Docker build, ECR push, Terraform apply sequence",
    "Specify script structure: destroy.sh with Terraform destroy sequence",
    "Specify script structure: test-e2e.sh with full test lifecycle",
    "Define error handling pattern for missing environment variables in LoadConfig",
    "Define main function signature and structure: initialization, handler registration, lambda.Start call",
    "Document that main.go must call lambda.Start with the universal Handler function",
    "Specify that Router.DetectEventType should check for API Gateway event structure first (requestContext, httpMethod)",
    "Specify that Router.DetectEventType should check for Step Function input structure second (start, iterations, delay_ms fields)",
    "Specify that Router.DetectEventType defaults to CustomEvent for other JSON payloads",
    "Define API Gateway response structure requirements: statusCode (int), headers (map), body (string - JSON encoded)",
    "Define build output: single statically-linked binary named 'bootstrap' per AWS Lambda Go runtime requirements",
    "Specify that all handlers return proper error types that Lambda runtime can serialize",
    "Specify that Step Function handler increments counter and calculates iterations_remaining correctly",
    "Define test assertions: API Gateway returns 200 status with expected JSON body",
    "Define test assertions: Custom Event returns source='custom-event' with echo field containing input",
    "Define test assertions: Step Function completes iteration cycle with final counter matching expected value",
    "Define package-level doc comment for package handlers describing Lambda event handler responsibilities",
    "Define package-level doc comment for package router describing event detection and routing responsibilities",
    "Define internal eventProbe struct with RequestContext, HTTPMethod (for API Gateway detection), and Iterations (for Step Function detection) fields for partial unmarshaling during event type detection",
    "Document dependency version requirements: github.com/aws/aws-lambda-go v1.51.2 (runtime), github.com/aws/aws-sdk-go-v2 v1.41.1 (test-only)",
    "Document import boundary: AWS SDK v2 imports only allowed in tests/e2e package, never in cmd/ or internal/",
    "Correct Docker binary location to /var/task/bootstrap (or ${LAMBDA_TASK_ROOT}/bootstrap) per AWS Lambda custom runtime requirements",
    "Document that Lambda execution role does NOT need states:StartExecution - Step Functions execution role invokes Lambda, not the reverse",
    "Define Terraform output for ecr_repository_url to enable deployment script ECR push operations",
    "Define Terraform variable lambda_memory (number, default 512) for Lambda memory configuration in MB",
    "Define Terraform variable lambda_timeout (number, default 30) for Lambda timeout configuration in seconds",
    "Define Terraform output for lambda_function_name for AWS CLI convenience commands",
    "Specify explicit go.mod content showing module path github.com/prethora/starter_golang_aws_lambda, Go version 1.23, and github.com/aws/aws-lambda-go v1.51.2 dependency",
    "Add Step Functions IAM role naming pattern ${STACK_NAME}-sfn-role to Section 8.3 resource naming conventions table",
    "Clarify Router design: make DetectEventType a package-level function (not a method) and remove the empty Router struct, OR make Router meaningful with state",
    "Define DelaySeconds field (float64, json tag 'delay_seconds') in StepFunctionOutput for State Machine Wait state compatibility, calculated as DelayMs/1000.0"
  ]
}